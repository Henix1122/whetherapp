<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WeatherSphere | Real-Time Weather App</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');
        
        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
        }
        
        .weather-card {
            background: rgba(255, 255, 255, 0.25);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: 20px;
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.18);
            transition: all 0.3s ease;
        }
        
        .weather-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 40px 0 rgba(31, 38, 135, 0.25);
        }
        
        .search-input:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.3);
        }
        
        .temperature {
            font-size: 5rem;
            font-weight: 300;
            line-height: 1;
        }
        
        .weather-icon {
            width: 100px;
            height: 100px;
        }
        
        .loading-spinner {
            border-top-color: #3b82f6;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .error-message {
            animation: shake 0.5s ease-in-out;
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20%, 60% { transform: translateX(-5px); }
            40%, 80% { transform: translateX(5px); }
        }
        
        .forecast-item {
            transition: all 0.3s ease;
        }
        
        .forecast-item:hover {
            transform: scale(1.05);
        }
        
        .sunrise-sunset {
            background: linear-gradient(90deg, #ff9966, #ff5e62);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }
        
        .animate-pulse {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .theme-toggle {
            transition: all 0.3s ease;
        }
        
        .theme-toggle:hover {
            transform: rotate(30deg);
        }
    </style>
</head>
<body class="flex items-center justify-center p-4">
    <div class="container mx-auto max-w-4xl">
        <div class="weather-card p-6 md:p-8 w-full">
            <!-- Header -->
            <header class="text-center mb-8 relative">
                <button id="theme-toggle" class="theme-toggle absolute right-0 top-0 text-gray-600 hover:text-blue-500">
                    <i class="fas fa-moon text-xl"></i>
                </button>
                <h1 class="text-3xl md:text-4xl font-bold text-gray-800 mb-2">WeatherSphere</h1>
                <p class="text-gray-600">Real-time weather information for any location</p>
            </header>
            
            <!-- Search Section -->
            <div class="flex flex-col md:flex-row gap-4 mb-8">
                <div class="relative flex-grow">
                    <input 
                        type="text"
                        id="location-input"
                        placeholder="City, City,CountryCode, Zip,CountryCode, or lat,lon (e.g. London,GB or 10001,US or 51.51,-0.13)"
                        class="search-input w-full px-5 py-3 rounded-full border border-gray-300 focus:border-blue-500 transition-all duration-300"
                        autocomplete="off"
                    >
                    <ul id="suggestion-list" class="absolute left-0 right-0 top-full z-10 bg-white border border-gray-200 rounded-xl shadow-lg mt-2 hidden max-h-60 overflow-y-auto"></ul>
                    <button id="current-location-btn" class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-blue-500">
                        <i class="fas fa-location-arrow"></i>
                    </button>
                </div>
                <button id="search-btn" class="bg-blue-500 hover:bg-blue-600 text-white px-6 py-3 rounded-full transition-colors duration-300 flex items-center justify-center gap-2">
                    <i class="fas fa-search"></i>
                    <span>Search</span>
                </button>
            </div>
            
            <!-- Loading State -->
            <div id="loading-state" class="hidden flex-col items-center justify-center py-12">
                <div class="loading-spinner h-12 w-12 border-4 border-blue-200 rounded-full mb-4"></div>
                <p class="text-gray-600 animate-pulse">Fetching weather data...</p>
            </div>
            
            <!-- Error State -->
            <div id="error-state" class="hidden bg-red-100 border-l-4 border-red-500 text-red-700 p-4 mb-6 rounded">
                <p id="error-message" class="error-message"></p>
            </div>
            
            <!-- Weather Display -->
            <div id="weather-display" class="hidden">
                <!-- Current Weather -->
                <div class="current-weather mb-8">
                    <div class="flex flex-col md:flex-row items-center justify-between">
                        <div class="text-center md:text-left mb-6 md:mb-0">
                            <h2 class="text-2xl font-semibold text-gray-800" id="location-name">--</h2>
                            <p class="text-gray-600" id="current-date">--</p>
                            <p class="text-gray-800 mt-2" id="weather-description">--</p>
                            <div class="flex items-center gap-4 mt-4">
                                <div class="flex items-center">
                                    <i class="fas fa-temperature-low text-blue-500 mr-2"></i>
                                    <span id="min-temp">--째</span>
                                </div>
                                <div class="flex items-center">
                                    <i class="fas fa-temperature-high text-red-500 mr-2"></i>
                                    <span id="max-temp">--째</span>
                                </div>
                            </div>
                            <div class="flex items-center gap-4 mt-2">
                                <div class="flex items-center sunrise-sunset">
                                    <i class="fas fa-sunrise mr-2"></i>
                                    <span id="sunrise">--:--</span>
                                </div>
                                <div class="flex items-center sunrise-sunset">
                                    <i class="fas fa-sunset mr-2"></i>
                                    <span id="sunset">--:--</span>
                                </div>
                            </div>
                        </div>
                        <div class="flex items-center">
                            <div id="weather-icon" class="weather-icon mr-4">
                                <i class="fas fa-sun text-yellow-400 text-6xl"></i>
                            </div>
                            <div class="temperature text-gray-800" id="current-temp">--째</div>
                        </div>
                    </div>
                </div>
                
                <!-- Weather Details -->
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
                    <div class="bg-white bg-opacity-50 p-4 rounded-xl text-center hover:bg-opacity-70 transition-all duration-300">
                        <i class="fas fa-temperature-high text-blue-500 text-xl mb-2"></i>
                        <p class="text-sm text-gray-600">Feels Like</p>
                        <p class="font-semibold text-gray-800" id="feels-like">--째</p>
                    </div>
                    <div class="bg-white bg-opacity-50 p-4 rounded-xl text-center hover:bg-opacity-70 transition-all duration-300">
                        <i class="fas fa-tint text-blue-400 text-xl mb-2"></i>
                        <p class="text-sm text-gray-600">Humidity</p>
                        <p class="font-semibold text-gray-800" id="humidity">--%</p>
                    </div>
                    <div class="bg-white bg-opacity-50 p-4 rounded-xl text-center hover:bg-opacity-70 transition-all duration-300">
                        <i class="fas fa-wind text-blue-300 text-xl mb-2"></i>
                        <p class="text-sm text-gray-600">Wind Speed</p>
                        <p class="font-semibold text-gray-800" id="wind-speed">-- km/h</p>
                    </div>
                    <div class="bg-white bg-opacity-50 p-4 rounded-xl text-center hover:bg-opacity-70 transition-all duration-300">
                        <i class="fas fa-compress-arrows-alt text-blue-600 text-xl mb-2"></i>
                        <p class="text-sm text-gray-600">Pressure</p>
                        <p class="font-semibold text-gray-800" id="pressure">-- hPa</p>
                    </div>
                </div>
                
                <!-- Forecast Section -->
                <div>
                    <h3 class="text-xl font-semibold text-gray-800 mb-4">5-Day Forecast</h3>
                    <div id="forecast-container" class="grid grid-cols-2 md:grid-cols-5 gap-4">
                        <!-- Forecast items will be added here by JavaScript -->
                    </div>
                </div>
                
                <!-- UV Index and Visibility -->
                <div class="grid grid-cols-2 gap-4 mt-8">
                    <div class="bg-white bg-opacity-50 p-4 rounded-xl hover:bg-opacity-70 transition-all duration-300">
                        <div class="flex items-center justify-between">
                            <div>
                                <i class="fas fa-sun text-yellow-500 text-xl mb-2"></i>
                                <p class="text-sm text-gray-600">UV Index</p>
                            </div>
                            <div class="flex items-center">
                                <span class="font-semibold text-gray-800 text-xl" id="uv-index">--</span>
                                <span id="uv-risk" class="ml-2 text-xs px-2 py-1 rounded-full"></span>
                            </div>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2 mt-2">
                            <div id="uv-progress" class="bg-green-500 h-2 rounded-full" style="width: 0%"></div>
                        </div>
                    </div>
                    <div class="bg-white bg-opacity-50 p-4 rounded-xl hover:bg-opacity-70 transition-all duration-300">
                        <i class="fas fa-eye text-indigo-500 text-xl mb-2"></i>
                        <p class="text-sm text-gray-600">Visibility</p>
                        <p class="font-semibold text-gray-800" id="visibility">-- km</p>
                    </div>
                </div>
            </div>
            
            <!-- Footer -->
            <footer class="mt-12 text-center text-sm text-gray-500">
                <p>Powered by OpenWeatherMap API</p>
                <p class="mt-1">짤 2023 WeatherSphere. All rights reserved.</p>
            </footer>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Search suggestions
            const suggestions = [
                'London,GB',
                'New York,US',
                'Tokyo,JP',
                'Paris,FR',
                'Berlin,DE',
                'Sydney,AU',
                'Toronto,CA',
                '10001,US',
                '94103,US',
                '51.51,-0.13',
                '35.68,139.76',
                'Lagos,NG',
                'Cape Town,ZA',
                'Rio de Janeiro,BR',
                'Moscow,RU',
                'Delhi,IN',
                'Beijing,CN',
                'Cairo,EG',
                'Johannesburg,ZA',
                'Melbourne,AU'
            ];
            const suggestionList = document.getElementById('suggestion-list');
            // DOM Elements
            const locationInput = document.getElementById('location-input');
            const searchBtn = document.getElementById('search-btn');
            const currentLocationBtn = document.getElementById('current-location-btn');
            const loadingState = document.getElementById('loading-state');
            const errorState = document.getElementById('error-state');
            const errorMessage = document.getElementById('error-message');
            const weatherDisplay = document.getElementById('weather-display');
            const themeToggle = document.getElementById('theme-toggle');
            
            // Weather display elements
            const locationName = document.getElementById('location-name');
            const currentDate = document.getElementById('current-date');
            const weatherDescription = document.getElementById('weather-description');
            const currentTemp = document.getElementById('current-temp');
            const feelsLike = document.getElementById('feels-like');
            const humidity = document.getElementById('humidity');
            const windSpeed = document.getElementById('wind-speed');
            const pressure = document.getElementById('pressure');
            const weatherIcon = document.getElementById('weather-icon');
            const forecastContainer = document.getElementById('forecast-container');
            const minTemp = document.getElementById('min-temp');
            const maxTemp = document.getElementById('max-temp');
            const sunrise = document.getElementById('sunrise');
            const sunset = document.getElementById('sunset');
            const uvIndex = document.getElementById('uv-index');
            const uvRisk = document.getElementById('uv-risk');
            const uvProgress = document.getElementById('uv-progress');
            const visibility = document.getElementById('visibility');
            
            // API Key (embedded)
            const API_KEY = '652fb19147b4b2e1ba9325651330b766';
            
            // Check for saved theme preference
            const savedTheme = localStorage.getItem('theme') || 'light';
            setTheme(savedTheme);
            
            // Event Listeners
            searchBtn.addEventListener('click', () => {
                const location = locationInput.value.trim();
                if (location) {
                    fetchWeatherData(location);
                }
            });
            
            currentLocationBtn.addEventListener('click', () => {
                if (navigator.geolocation) {
                    navigator.geolocation.getCurrentPosition(
                        position => {
                            const { latitude, longitude } = position.coords;
                            fetchWeatherDataByCoords(latitude, longitude);
                        },
                        error => {
                            showError("Unable to retrieve your location. Please enable location services or search manually.");
                        }
                    );
                } else {
                    showError("Geolocation is not supported by your browser.");
                }
            });
            
            locationInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    const location = locationInput.value.trim();
                    if (location) {
                        fetchWeatherData(location);
                    }
                }
            });

            // Show suggestions as user types
            locationInput.addEventListener('input', function() {
                const value = locationInput.value.trim().toLowerCase();
                if (!value) {
                    suggestionList.innerHTML = '';
                    suggestionList.classList.add('hidden');
                    return;
                }
                const filtered = suggestions.filter(s => s.toLowerCase().includes(value));
                if (filtered.length === 0) {
                    suggestionList.innerHTML = '';
                    suggestionList.classList.add('hidden');
                    return;
                }
                suggestionList.innerHTML = filtered.map(s => `<li class="px-5 py-3 cursor-pointer hover:bg-blue-100">${s}</li>`).join('');
                suggestionList.classList.remove('hidden');
            });

            // Click suggestion to select
            suggestionList.addEventListener('mousedown', function(e) {
                if (e.target.tagName === 'LI') {
                    locationInput.value = e.target.textContent;
                    suggestionList.classList.add('hidden');
                    locationInput.focus();
                }
            });

            // Hide suggestions on blur
            locationInput.addEventListener('blur', function() {
                setTimeout(() => suggestionList.classList.add('hidden'), 100);
            });
            
            themeToggle.addEventListener('click', () => {
                const currentTheme = document.documentElement.classList.contains('dark') ? 'dark' : 'light';
                const newTheme = currentTheme === 'light' ? 'dark' : 'light';
                setTheme(newTheme);
                localStorage.setItem('theme', newTheme);
            });
            
            // Initial load - fetch weather for a default location
            fetchWeatherData('London');
            
            // Functions
            function setTheme(theme) {
                if (theme === 'dark') {
                    document.documentElement.classList.add('dark');
                    themeToggle.innerHTML = '<i class="fas fa-sun text-xl"></i>';
                    themeToggle.title = 'Switch to light mode';
                } else {
                    document.documentElement.classList.remove('dark');
                    themeToggle.innerHTML = '<i class="fas fa-moon text-xl"></i>';
                    themeToggle.title = 'Switch to dark mode';
                }
            }
            
            async function fetchWeatherData(location) {
                try {
                    showLoading();
                    hideError();
                    location = location.trim();
                    let weatherUrl = '';
                    let forecastUrl = '';
                    
                    // Detect input type
                    if (/^-?\d{1,3}\.\d+,-?\d{1,3}\.\d+$/.test(location)) {
                        // lat,lon
                        const [lat, lon] = location.split(',').map(Number);
                        if (isNaN(lat) || isNaN(lon)) throw new Error('Invalid coordinates. Use format: lat,lon');
                        weatherUrl = `https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&units=metric&appid=${API_KEY}`;
                        forecastUrl = `https://api.openweathermap.org/data/2.5/forecast?lat=${lat}&lon=${lon}&units=metric&appid=${API_KEY}`;
                    } else if (/^\d{5}(?:[-\s]\d{4})?(,\w{2})?$/.test(location)) {
                        // US Zip or Zip,CountryCode
                        const [zip, country] = location.split(',');
                        weatherUrl = `https://api.openweathermap.org/data/2.5/weather?zip=${zip}${country ? ',' + country : ''}&units=metric&appid=${API_KEY}`;
                        forecastUrl = `https://api.openweathermap.org/data/2.5/forecast?zip=${zip}${country ? ',' + country : ''}&units=metric&appid=${API_KEY}`;
                    } else if (/^[^,]+,[A-Za-z]{2}$/.test(location)) {
                        // City,CountryCode
                        weatherUrl = `https://api.openweathermap.org/data/2.5/weather?q=${location}&units=metric&appid=${API_KEY}`;
                        forecastUrl = `https://api.openweathermap.org/data/2.5/forecast?q=${location}&units=metric&appid=${API_KEY}`;
                    } else if (/^[A-Za-z\s]+$/.test(location)) {
                        // City only
                        weatherUrl = `https://api.openweathermap.org/data/2.5/weather?q=${location}&units=metric&appid=${API_KEY}`;
                        forecastUrl = `https://api.openweathermap.org/data/2.5/forecast?q=${location}&units=metric&appid=${API_KEY}`;
                    } else {
                        throw new Error('Invalid input. Use city, city,country, zip,country, or lat,lon.');
                    }
                    
                    const response = await fetch(weatherUrl);
                    if (!response.ok) {
                        throw new Error('Location not found. Try a valid city, city,country, zip,country, or lat,lon.');
                    }
                    
                    const data = await response.json();
                    
                    // Fetch forecast data
                    const forecastResponse = await fetch(forecastUrl);
                    if (!forecastResponse.ok) {
                        throw new Error('Could not fetch forecast data.');
                    }
                    
                    const forecastData = await forecastResponse.json();
                    
                    // Fetch UV index (requires separate API call)
                    let uvData = null;
                    try {
                        const uvResponse = await fetch(`https://api.openweathermap.org/data/2.5/uvi?lat=${data.coord.lat}&lon=${data.coord.lon}&appid=${API_KEY}`);
                        if (uvResponse.ok) {
                            uvData = await uvResponse.json();
                        }
                    } catch (e) {
                        console.error("Could not fetch UV index", e);
                    }
                    
                    displayWeatherData(data, forecastData, uvData);
                } catch (error) {
                    showError(error.message);
                } finally {
                    hideLoading();
                }
            }
            
            async function fetchWeatherDataByCoords(lat, lon) {
                try {
                    showLoading();
                    hideError();
                    
                    const response = await fetch(
                        `https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&units=metric&appid=${API_KEY}`
                    );
                    
                    if (!response.ok) {
                        throw new Error('Could not fetch weather data for your location.');
                    }
                    
                    const data = await response.json();
                    
                    // Fetch forecast data
                    const forecastResponse = await fetch(
                        `https://api.openweathermap.org/data/2.5/forecast?lat=${lat}&lon=${lon}&units=metric&appid=${API_KEY}`
                    );
                    
                    if (!forecastResponse.ok) {
                        throw new Error('Could not fetch forecast data.');
                    }
                    
                    const forecastData = await forecastResponse.json();
                    
                    // Fetch UV index
                    let uvData = null;
                    try {
                        const uvResponse = await fetch(`https://api.openweathermap.org/data/2.5/uvi?lat=${lat}&lon=${lon}&appid=${API_KEY}`);
                        if (uvResponse.ok) {
                            uvData = await uvResponse.json();
                        }
                    } catch (e) {
                        console.error("Could not fetch UV index", e);
                    }
                    
                    displayWeatherData(data, forecastData, uvData);
                    locationInput.value = data.name; // Update input with location name
                } catch (error) {
                    showError(error.message);
                } finally {
                    hideLoading();
                }
            }
            
            function displayWeatherData(data, forecastData, uvData) {
                // Update current weather
                locationName.textContent = `${data.name}, ${data.sys.country}`;
                
                const now = new Date();
                currentDate.textContent = now.toLocaleDateString('en-US', { 
                    weekday: 'long', 
                    year: 'numeric', 
                    month: 'long', 
                    day: 'numeric' 
                });
                
                weatherDescription.textContent = data.weather[0].description;
                currentTemp.textContent = `${Math.round(data.main.temp)}째`;
                feelsLike.textContent = `${Math.round(data.main.feels_like)}째`;
                humidity.textContent = `${data.main.humidity}%`;
                windSpeed.textContent = `${Math.round(data.wind.speed * 3.6)} km/h`; // Convert m/s to km/h
                pressure.textContent = `${data.main.pressure} hPa`;
                minTemp.textContent = `${Math.round(data.main.temp_min)}째`;
                maxTemp.textContent = `${Math.round(data.main.temp_max)}째`;
                visibility.textContent = `${(data.visibility / 1000).toFixed(1)} km`;
                
                // Update sunrise/sunset times
                const sunriseTime = new Date(data.sys.sunrise * 1000);
                const sunsetTime = new Date(data.sys.sunset * 1000);
                sunrise.textContent = sunriseTime.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                sunset.textContent = sunsetTime.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                
                // Update UV index if available
                if (uvData) {
                    const uvValue = Math.round(uvData.value * 10) / 10;
                    uvIndex.textContent = uvValue;
                    
                    // Set UV risk level and color
                    let riskLevel = '';
                    let bgColor = '';
                    let textColor = '';
                    
                    if (uvValue <= 2) {
                        riskLevel = 'Low';
                        bgColor = 'bg-green-100';
                        textColor = 'text-green-800';
                    } else if (uvValue <= 5) {
                        riskLevel = 'Moderate';
                        bgColor = 'bg-yellow-100';
                        textColor = 'text-yellow-800';
                    } else if (uvValue <= 7) {
                        riskLevel = 'High';
                        bgColor = 'bg-orange-100';
                        textColor = 'text-orange-800';
                    } else if (uvValue <= 10) {
                        riskLevel = 'Very High';
                        bgColor = 'bg-red-100';
                        textColor = 'text-red-800';
                    } else {
                        riskLevel = 'Extreme';
                        bgColor = 'bg-purple-100';
                        textColor = 'text-purple-800';
                    }
                    
                    uvRisk.textContent = riskLevel;
                    uvRisk.className = `${bgColor} ${textColor} ml-2 text-xs px-2 py-1 rounded-full`;
                    
                    // Set UV progress bar (max 12 for visualization)
                    const progressPercent = Math.min(uvValue / 12 * 100, 100);
                    uvProgress.style.width = `${progressPercent}%`;
                    
                    // Set progress bar color based on UV level
                    if (uvValue <= 2) {
                        uvProgress.className = 'bg-green-500 h-2 rounded-full';
                    } else if (uvValue <= 5) {
                        uvProgress.className = 'bg-yellow-500 h-2 rounded-full';
                    } else if (uvValue <= 7) {
                        uvProgress.className = 'bg-orange-500 h-2 rounded-full';
                    } else if (uvValue <= 10) {
                        uvProgress.className = 'bg-red-500 h-2 rounded-full';
                    } else {
                        uvProgress.className = 'bg-purple-500 h-2 rounded-full';
                    }
                }
                
                // Update weather icon
                updateWeatherIcon(data.weather[0].icon, weatherIcon);
                
                // Update forecast
                updateForecast(forecastData);
                
                // Show weather display
                weatherDisplay.classList.remove('hidden');
            }
            
            function updateWeatherIcon(iconCode, element) {
                const iconMap = {
                    '01d': 'sun',        // clear sky (day)
                    '01n': 'moon',       // clear sky (night)
                    '02d': 'cloud-sun',  // few clouds (day)
                    '02n': 'cloud-moon', // few clouds (night)
                    '03d': 'cloud',      // scattered clouds
                    '03n': 'cloud',
                    '04d': 'cloud',      // broken clouds
                    '04n': 'cloud',
                    '09d': 'cloud-rain', // shower rain
                    '09n': 'cloud-rain',
                    '10d': 'cloud-sun-rain', // rain (day)
                    '10n': 'cloud-moon-rain', // rain (night)
                    '11d': 'bolt',       // thunderstorm
                    '11n': 'bolt',
                    '13d': 'snowflake',  // snow
                    '13n': 'snowflake',
                    '50d': 'smog',       // mist
                    '50n': 'smog'
                };
                
                const colorMap = {
                    '01d': 'text-yellow-400',
                    '01n': 'text-gray-400',
                    '02d': 'text-yellow-300',
                    '02n': 'text-gray-300',
                    '03d': 'text-gray-400',
                    '03n': 'text-gray-400',
                    '04d': 'text-gray-500',
                    '04n': 'text-gray-500',
                    '09d': 'text-blue-400',
                    '09n': 'text-blue-400',
                    '10d': 'text-blue-500',
                    '10n': 'text-blue-500',
                    '11d': 'text-yellow-500',
                    '11n': 'text-yellow-500',
                    '13d': 'text-blue-200',
                    '13n': 'text-blue-200',
                    '50d': 'text-gray-300',
                    '50n': 'text-gray-300'
                };
                
                const icon = iconMap[iconCode] || 'question-circle';
                const color = colorMap[iconCode] || 'text-gray-500';
                
                element.innerHTML = `<i class="fas fa-${icon} ${color} text-6xl"></i>`;
            }
            
            function updateForecast(forecastData) {
                // Clear previous forecast
                forecastContainer.innerHTML = '';
                
                // Filter to get one forecast per day (at 12:00 PM)
                const dailyForecasts = forecastData.list.filter(item => {
                    const date = new Date(item.dt * 1000);
                    return date.getHours() === 12;
                }).slice(0, 5); // Get next 5 days
                
                if (dailyForecasts.length === 0) {
                    // If no 12:00 PM forecasts, just take the first 5 available
                    dailyForecasts.push(...forecastData.list.slice(0, 5));
                }
                
                dailyForecasts.forEach(forecast => {
                    const date = new Date(forecast.dt * 1000);
                    const day = date.toLocaleDateString('en-US', { weekday: 'short' });
                    const temp = Math.round(forecast.main.temp);
                    
                    const forecastItem = document.createElement('div');
                    forecastItem.className = 'forecast-item bg-white bg-opacity-50 p-3 rounded-xl text-center hover:bg-opacity-70 transition-all duration-300';
                    
                    const iconContainer = document.createElement('div');
                    iconContainer.className = 'flex justify-center mb-2';
                    updateWeatherIcon(forecast.weather[0].icon, iconContainer);
                    
                    forecastItem.innerHTML = `
                        <p class="font-medium text-gray-800">${day}</p>
                        ${iconContainer.outerHTML}
                        <p class="text-gray-800"><span class="font-semibold">${temp}째</span></p>
                        <div class="flex justify-center gap-2 mt-1">
                            <span class="text-xs text-red-500">${Math.round(forecast.main.temp_max)}째</span>
                            <span class="text-xs text-blue-500">${Math.round(forecast.main.temp_min)}째</span>
                        </div>
                    `;
                    
                    forecastContainer.appendChild(forecastItem);
                });
            }
            
            function showLoading() {
                loadingState.classList.remove('hidden');
                weatherDisplay.classList.add('hidden');
            }
            
            function hideLoading() {
                loadingState.classList.add('hidden');
            }
            
            function showError(message) {
                errorMessage.textContent = message;
                errorState.classList.remove('hidden');
                weatherDisplay.classList.add('hidden');
            }
            
            function hideError() {
                errorState.classList.add('hidden');
            }
        });
    </script>
</body>
</html>